# Руководство по установке FunPay Pro

## Шаг 1: Подготовка

### Требования
- Node.js версии 16 или выше
- npm или yarn
- Современный браузер (Chrome, Firefox, Edge)

### Проверка установленных версий
```bash
node --version  # должна быть >= 16
npm --version
```

## Шаг 2: Установка Backend сервера

### 2.1 Установка зависимостей

```bash
# Из корневой папки проекта
cd backend
npm install
```

### 2.2 Конфигурация

Создайте файл `.env` в папке `backend`:
```bash
cp .env.example .env
```

Отредактируйте `.env` при необходимости:
```env
PORT=3000
NODE_ENV=development
```

### 2.3 Запуск сервера

Для продакшн:
```bash
npm start
```

Для разработки (с автоперезагрузкой):
```bash
npm run dev
```

Проверьте что сервер запустился:
```bash
curl http://localhost:3000/api/health
```

Должен вернуть:
```json
{"status":"ok","timestamp":1234567890}
```

## Шаг 3: Установка расширения в Chrome/Edge

### 3.1 Открыть страницу расширений

**Chrome:**
1. Откройте Chrome
2. Перейдите по адресу: `chrome://extensions/`

**Edge:**
1. Откройте Edge
2. Перейдите по адресу: `edge://extensions/`

### 3.2 Включить режим разработчика

В правом верхнем углу найдите переключатель "Режим разработчика" (Developer mode) и включите его.

### 3.3 Загрузить расширение

1. Нажмите кнопку "Загрузить распакованное расширение" (Load unpacked)
2. Выберите корневую папку проекта (где находится `manifest.json`)
3. Расширение должно появиться в списке

### 3.4 Проверка установки

- Иконка расширения должна появиться на панели браузера
- Нажмите на иконку - должен открыться popup
- Перейдите на funpay.com - должна появиться плавающая кнопка

## Шаг 4: Установка в Firefox

### 4.1 Открыть отладку расширений

1. Откройте Firefox
2. В адресной строке введите: `about:debugging#/runtime/this-firefox`
3. Нажмите Enter

### 4.2 Загрузить временное дополнение

1. Нажмите "Load Temporary Add-on" (Загрузить временное дополнение)
2. Выберите файл `manifest.json` из корневой папки проекта
3. Расширение загрузится

### 4.3 Примечание для Firefox

Временные дополнения в Firefox удаляются при перезапуске браузера. Для постоянной установки необходимо:
- Подписать расширение через AMO (addons.mozilla.org)
- Или использовать Developer Edition/Nightly с отключенной проверкой подписи

## Шаг 5: Первоначальная настройка

### 5.1 Авторизация на FunPay

1. Перейдите на https://funpay.com
2. Войдите в свой аккаунт
3. Расширение автоматически получит cookies для работы

### 5.2 Настройка расширения

1. Нажмите на иконку расширения
2. Кликните на "Настройки"
3. Настройте параметры:
   - Интервал обновления: 15-30 минут (рекомендуется)
   - Стратегия ценообразования: "Конкурентная" (по умолчанию)
   - Включите уведомления
   - Проверьте Backend URL: `http://localhost:3000/api`

### 5.3 Проверка работы

1. Откройте любую страницу товара на FunPay.com
2. Должна появиться плавающая кнопка расширения
3. Нажмите на неё - откроется панель с анализом
4. Откройте Dashboard для полной аналитики

## Шаг 6: Устранение неполадок

### Backend сервер не запускается

**Проблема:** Порт 3000 занят
```bash
# Найти процесс на порту 3000
lsof -i :3000  # Mac/Linux
netstat -ano | findstr :3000  # Windows

# Изменить порт в .env
PORT=3001
```

**Проблема:** Ошибки установки npm
```bash
# Очистить кэш и переустановить
rm -rf node_modules package-lock.json
npm cache clean --force
npm install
```

### Расширение не загружается

**Проблема:** Manifest ошибки
- Проверьте что вы выбрали корневую папку (где manifest.json)
- Убедитесь что все файлы на месте
- Проверьте консоль браузера на ошибки

**Проблема:** Иконки не отображаются
- Иконки - это placeholder'ы, это нормально
- Функциональность не затронута

### Расширение не видит FunPay

**Проблема:** Не работает на funpay.com
- Проверьте что вы на https://funpay.com
- Перезагрузите страницу
- Проверьте что расширение включено

**Проблема:** Нет авторизации
- Войдите на funpay.com через браузер
- Перезагрузите расширение
- Проверьте cookies в DevTools

### Backend не отвечает

**Проблема:** Connection refused
```bash
# Проверьте что сервер запущен
curl http://localhost:3000/api/health

# Проверьте логи сервера
# Убедитесь что нет ошибок при запуске
```

**Проблема:** CORS ошибки
- Backend настроен на работу с любым origin
- Проверьте настройки браузера
- Откройте консоль браузера для деталей

## Шаг 7: Обновление расширения

### Обновить код расширения

1. Получите последние изменения (git pull)
2. В браузере на странице расширений нажмите "Обновить" (Reload)
3. Расширение перезагрузится с новым кодом

### Обновить Backend

```bash
cd backend
git pull  # или получить новый код
npm install  # если обновились зависимости
npm start  # перезапустить сервер
```

## Шаг 8: Производственное использование

### Безопасность

1. Измените `.env` для production:
```env
NODE_ENV=production
CORS_ORIGIN=chrome-extension://ваш-id
```

2. Добавьте rate limiting
3. Используйте HTTPS для backend
4. Не храните чувствительные данные

### Упаковка расширения

```bash
# Создать ZIP для распространения
npm run package
```

Это создаст файл `funpay-pro-extension.zip` для публикации.

## Дополнительная помощь

- Откройте issues в репозитории
- Проверьте логи в консоли браузера (F12)
- Проверьте логи backend сервера
- Прочитайте README.md для деталей API

## Полезные команды

```bash
# Backend
npm run backend:install  # Установить зависимости backend
npm run backend         # Запустить backend
npm run backend:dev     # Запустить backend в dev режиме

# Extension
npm run build           # Подготовить расширение
npm run package         # Упаковать в ZIP
```

---

**Поздравляем!** Расширение FunPay Pro установлено и готово к использованию.
